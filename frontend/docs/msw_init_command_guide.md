# MSWセットアップ手順＆解説

MSW (Mock Service Worker) を導入することで、バックエンドAPIが未完成でも、フロントエンド開発をスムーズに進めることができる。

---

## ステップ1: インストール

まずは、MSWライブラリをプロジェクトに召喚する。

```bash
npm install msw --save-dev
```

`--save-dev` は、このライブラリが開発中にのみ使用するものであることを示している。

---

## ステップ2: Service Workerの生成 (`npx msw init public/`)

次に、MSWの心臓部であるService Workerスクリプトを生成し、配置する。

```bash
npx msw init public/
```

### このコマンドが持つ意味

このコマンドは、MSWを使った開発戦略において、極めて重要な意味を持つ一手だ。

#### 結論

このコマンドが実行することは、**「お前のブラウザに、偽のAPIサーバーとして振る舞うための"魔法回路"（Service Worker）を埋め込む」**ための準備作業である。

---

## なぜ「Service Worker」という魔法が必要なのか？

通常、フロントエンドがAPIリクエストを投げると、それはインターネットを経由してバックエンドサーバーに届く。しかし、バックエンドがまだ開発中の場合、そのリクエストは宛先を失い、エラーとなる。

そこで**Service Worker**の出番だ。これは、ブラウザ自身の中に常駐させることができる、一種の「門番」のようなプログラムだ。

`npx msw init public/` を実行すると、この門番のスクリプト（`mockServiceWorker.js`）が生成される。

一度セットアップが完了すると、この門番はフロントエンドが投げるすべてのリクエストを監視し、それが我々の定義したモックAPIへのリクエストだった場合、以下の動作を行う。

1.  **通信をブロック:** そのリクエストがインターネットに出ていくのを防ぐ。
2.  **偽の応答を返す:** 我々が予め用意しておいた偽のデータ（モックデータ）を、あたかも本物のサーバーから返ってきたかのように見せかけてフロントエンドに返す。

この一連の流れは、すべてブラウザの中だけで完結するため、バックエンドが一切存在しなくても、フロントエンドは本物のAPIと通信しているかのように開発を進めることができる。

## なぜ `public/` ディレクトリなのか？

これが最も重要な点だ。

Next.jsでは、`public` ディレクトリは特別な場所であり、この中にあるファイルはサイトのルート（例: `http://localhost:3000/`）直下に配置される。

Service Workerという魔法は、**サイト全体をその支配下に置く**ために、サイトのルートから読み込まれる必要がある。もしこのスクリプトが他の場所にあれば、その効力は限定的なものになってしまう。

## まとめ

`npx msw init public/` というコマンドは、

**「サイト全体のリクエストを監視できる特別な場所（`public/`）に、通信を横取りして偽の応答を返す門番（`mockServiceWorker.js`）を配置しろ！」**

という、デュエル戦術の根幹を成す、重要な命令なのである。
